# Хороший попап
jQuery-плагин с хорошей разметкой попапа.

## Демо
https://eugene-lazarev.github.io/jquery-goodpopup/

## Сборка
`npm install && grunt`

## Установка
```html
<!-- Зависимости: jQuery и Handlebars -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.11/handlebars.min.js"></script>

<!-- Плагин -->
<script src="jquery.goodpopup/js/script.min.js"></script>
<link href="jquery.goodpopup/css/style.min.css" rel="stylesheet" type="text/css"/>
```

## Использование
### Базовый пример
#### Шаблон Handlebars
Добавьте в конец страницы шаблон handlebars, содержащий *внутреннюю* разметку попапа, используя уникальный `id`:
```html
<script id="goodpopup1" type="text/x-handlebars-template">
    <div>
        <h1>Hello world</h1>
    </div>
</script>
```
В любой момент откройте попап, используя `id` шаблона:
```javascript
$.goodpopup.getPopup("goodpopup1").open()
```
А потом закройте:
```javascript
$.goodpopup.getPopup("goodpopup1").close()
```
#### Шаблон из блока
Добавьте любому блоку `id`, и вы сможете открывать его содержимое в попапе:
```html
<div id="goodpopup2">
    <h1>Hello world</h1>
</div>
```

### API
Экземпляр попапа (далее `popup_instance`) можно получить тремя способами:

1. Взять напрямую по имени: `$.goodpopup.getPopup("goodpopup1")`;
2. Обратиться к `data-popup` у DOM-элемента handlebars-шаблона (т.е. тега `<script>` с нужным `id`);
3. Посмотреть в `$.goodpopup.getPopups()`.

#### Опции
Могут быть установлены тремя способами:

1. Через data-атрибуты у шаблона (т.е. тега `<script>`);
2. Через метод `popup_instance.setOptions()` (см. ниже);
3. При ручной инициализации попапа: `$("script[type='text/x-handlebars-template']").goodpopup({})`.

##### `isDetachable`
Тип: `boolean`
По умолчанию `false`

Определяет, нужно ли сохранять содержимое попапа при его скрытии (т.е. использовать метод `detach` вместо `remove`).

##### `hasCloseButton`
Тип: `boolean`
По умолчанию `true`

Определяет, нужна ли этому попапу стандартная кнопка закрытия («крестик»).
При изменении опции «на лету» кнопка закрытия корректно появляется и исчезает.

##### `isOuterClickClosing`
Тип: `boolean`
По умолчанию `true`

Определяет, нужно ли закрывать попап по клику вне зоны содержимого попапа (в область фона).

##### `keyCodeForClosing`
Тип: `number`, `array`
По умолчанию `[27]`

Указывает, по нажатию каких клавиш закрывать все открытые попапы. Может быть числом или массивом чисел.
Значение по умолчанию соответствует кнопке *Esc*.
Посмотреть коды разных клавиш можно, например, на сайте [keycode.info](http://keycode.info).
Чтобы оключить закрытие всех открытых попапов по нажатию клавиш, передайте значение `false`.

##### `isPrerendered`
Тип: `boolean`
По умолчанию `false`

Определяет, нужно ли отрендерить содержимое попапа сразу после загрузки страницы, не дожидаясь, пока попап будет открыт.
Срабатывает только если эта опция была определена до инициализации плагина, рекомендуется устанавливать через data-атрибут.

##### `isIframe`
Тип: `boolean`
По умолчанию `false`

Определяет, нужно ли оставлять содержимое попапа в DOM после закрытия попапа.
Особенно полезно использовать, если в содержимом попапа используется iframe. Если не использовать опцию, каждый раз при открытии попапа iframe, находящийся внутри попапа, будет перезагружен (таковы особенности работы браузера при перемещении iframe по DOM).


##### `forceClosing`
Тип: `object`
По умолчанию:
```javascript
{
    click: true,
    keydown: true,
    button: false
}
```
Каждое значение определяет, нужно ли по соответствующему событию закрыть все открытые попапы единовременно (`true`), либо же закрыть открытый попап и показать открывавшийся до этого (`false`).
- `click` — клик вне зоны содержимого попапа (работает при установленной опции `isOuterClickClosing: true`);
- `keydown` — нажатие клавиш, определённых в опции `keyCodeForClosing`;
- `button` — клик по «крестику» (работает при установленной опции `hasCloseButton: true`).


#### Коллбеки
Устанавливаются как опции. Вызываются в нужный момент.

##### `callbackBeforeOpen`
Вызывается перед тем, как попап будет открыт.

##### `callbackAfterOpen`
Вызывается после того, как попап будет открыт.

##### `callbackBeforeClose`
Вызывается перед тем, как попап будет закрыт.

##### `callbackAfterClose`
Вызывается после того, как попап будет закрыт.


#### Дополнительные данные
##### `data`
Handlebars позволяет использовать объект с данными для дополнительной гибкости при рендеринге шаблона.
Вы можете в любой момент *до вызова `popup_instance.open()`* передать эти данные, установив опцию `data`. Это обычный объект.


#### Методы
##### `popup_instance.open()`
Открыть попап.

##### `popup_instance.close(true)`
Закрыть попап.
Аргумент показывает, нужно ли закрыть все открытые попапы единовременно (`true`), либо же закрыть открытый попап и показать открывавшийся до этого (значение по умолчанию, `false`).

##### `popup_instance.dequeue()`
Убрать попап из очереди скрытых попапов.

##### `popup_instance.isRendered()`
Отрендерен ли попап (независимо от того, показывается он в данный момент или находится в стеке скрытых попапов).

##### `popup_instance.isHidden()`
Скрыт ли в данный момент попап.

##### `popup_instance.setOptions({})`
Установить новые опции.

##### `popup_instance.getOptions()`
Возвращает объект со всеми опциями.

##### `popup_instance.getPopupContent()`
Возвращает jQuery-объект с разметкой содержимого попапа (всё, что было в шаблоне, положенное в родителя — `<div class="goodpopup-inner-content-element">`).

##### `popup_instance.getPopupId()`
Возвращает `id` попапа.

##### `popup_instance.getTemplate()`
Возвращает jQuery-объект блока, из которого создаётся содержимое попапа (handlebars-шаблон или блок с соответствующим `id`).


### Глобальный объект `$.goodpopup`
Содержит методы для манипуляции попапами.

#### `$.goodpopup.getPopup(popup_name)`
Возвращает `popup_instance` от попапа с `popup_name`, соответствующим `id` попапа.

#### `$.goodpopup.getPopups()`
Возвращает объект со всеми попапами (не включая попапы, созданные из блоков и до сих пор не показывавшиеся).

#### `$.goodpopup.getQueue()`
Возвращает массив с очередью показанных ранее, а сейчас скрытых попапов. Удалить попап из очереди можно, воспользовавшись методом `popup_instance.dequeue()`.


## Лицензия
[MIT License](LICENSE.md)
